# Tasks - ğŸ“° Substack Daily

## Phase 0: åˆå§‹åŒ–

### T0.1 åˆ›å»ºé¡¹ç›®ä¸ç¯å¢ƒ
- åœ¨ Cursor ä¸­åˆ›å»ºæ–°é¡¹ç›® `substack-daily`
- é€‰æ‹©æ¨¡æ¿ï¼š**Next.js + TailwindCSS**
- åœ¨é¡¹ç›®æ ¹ç›®å½•åˆå§‹åŒ– git ä»“åº“å¹¶æ¨é€åˆ° GitHub  
  ```bash
  git init
  git add .
  git commit -m "init Substack Daily MVP"
  git branch -M main
  git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/substack-daily.git
  git push -u origin main
  ```

éªŒæ”¶ï¼š
- [ ] æœ¬åœ°è¿è¡Œ `npm run dev` å¯è®¿é—®é¦–é¡µ  
- [ ] é¡µé¢æˆåŠŸåœ¨æµè§ˆå™¨æ˜¾ç¤º  
- [ ] GitHub ä»“åº“åŒæ­¥æˆåŠŸ  

---

## Phase 1: æ•°æ®æºä¸è‡ªåŠ¨åŒ–

### T1.1 Supabase æ•°æ®åº“è®¾ç½®
- åœ¨ supabase.com åˆ›å»ºé¡¹ç›®  
- æ–°å»ºè¡¨ `picks`  
  ```sql
  CREATE TABLE picks (
    id bigint generated by default as identity primary key,
    the_date date not null,
    kind text check (kind in ('daily', 'weekly')),
    items jsonb not null
  );
  ```
- åœ¨ Supabase ä»ªè¡¨æ¿è·å–ï¼š
  - `SUPABASE_URL`
  - `SUPABASE_ANON_KEY`

éªŒæ”¶ï¼š
- [ ] è¡¨åˆ›å»ºæˆåŠŸ  
- [ ] æ§åˆ¶å°å¯æ‰‹åŠ¨æ’å…¥ä¸€æ¡ JSON æµ‹è¯•è®°å½•  
- [ ] å¯åœ¨ Supabase UI ä¸­æŸ¥çœ‹è®°å½•  

---

### T1.2 n8n è‡ªåŠ¨åŒ–æµç¨‹
- æœ¬åœ°æˆ–äº‘ç«¯éƒ¨ç½² n8nï¼ˆæ¨è n8n.io/cloudï¼‰  
- åˆ›å»ºæ–°å·¥ä½œæµ â€œSubstack Daily Automationâ€ï¼š
  1. **Schedule Trigger**ï¼šæ¯å¤©ä¸­åˆ 12:00 è¿è¡Œ  
  2. **IF Node**ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºå‘¨æ—¥  
  3. **OpenAI Node**ï¼š  
     - Prompt è¯´æ˜ï¼šè¾“å‡º 3 ç¯‡ï¼ˆå‘¨ä¸€â€“å…­ï¼‰æˆ– 5 ç¯‡ï¼ˆå‘¨æ—¥ï¼‰Substack AI ç›¸å…³æ–‡ç«   
     - è¾“å‡º JSON æ ¼å¼ï¼š
       ```json
       [
         {"title":"","author":"","url":"","summary":"","reason":""}
       ]
       ```
  4. **Supabase Node**ï¼š  
     - æ’å…¥è¡¨ `picks`  
     - `the_date = {{$now.toISODate()}}`  
     - `kind = {{$json.length > 3 ? "weekly" : "daily"}}`  
     - `items = {{$json}}`

éªŒæ”¶ï¼š
- [ ] æ¯å¤©è‡ªåŠ¨è§¦å‘æˆåŠŸ  
- [ ] Supabase è¡¨ä¸­å‡ºç°å½“å¤© JSON æ•°æ®  
- [ ] å‘¨æ—¥åˆ‡æ¢ä¸º weekly 5 ç¯‡æ¨¡å¼æ­£å¸¸  

---

## Phase 2: å‰ç«¯å¼€å‘

### T2.1 API è¿æ¥ Supabase
- åœ¨ `.env.local` æ·»åŠ ï¼š
  ```env
  NEXT_PUBLIC_SUPABASE_URL=ä½ çš„_SUPABASE_URL
  NEXT_PUBLIC_SUPABASE_KEY=ä½ çš„_SUPABASE_ANON_KEY
  ```
- åœ¨ `/lib/supabaseClient.ts`ï¼š
  ```ts
  import { createClient } from '@supabase/supabase-js'

  export const supabase = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_KEY!
  )
  ```
- åœ¨é¦–é¡µ `app/page.tsx`ï¼ˆæˆ– `pages/index.tsx`ï¼‰è·å–æœ€æ–°æ•°æ®ï¼š
  ```ts
  import { supabase } from '@/lib/supabaseClient'

  export default async function Page() {
    const { data, error } = await supabase
      .from('picks')
      .select('*')
      .order('the_date', { ascending: false })
      .limit(1)
      .single()

    if (error) {
      return <div className="p-6 text-red-600">åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚</div>
    }

    const items = (data?.items ?? []) as {
      title: string; author: string; url: string; summary: string; reason: string
    }[]

    const isWeekly = data?.kind === 'weekly'

    return (
      <main className="mx-auto max-w-5xl px-4 py-10">
        {/* Header */}
        <header className="flex items-center justify-between mb-10">
          <div className="text-2xl font-serif">Substack Daily</div>
          <nav className="flex gap-6 text-sm text-neutral-700">
            <a href="#today" className="hover:underline">ä»Šæ—¥æ¨è</a>
            <a href="#archive" className="hover:underline">å†å²å½’æ¡£</a>
            <a href="#about" className="hover:underline">å…³äº</a>
          </nav>
        </header>

        {/* Hero */}
        <section id="today" className="mb-12">
          <h1 className="mb-6 text-3xl font-serif">
            {isWeekly ? 'å½“å‘¨ç²¾é€‰' : 'ä»Šæ—¥ç²¾é€‰'}
          </h1>

          {items.length > 0 && (
            <article className="rounded-2xl overflow-hidden bg-white shadow-sm">
              <img
                alt={items[0].title}
                className="w-full aspect-video object-cover transition-transform duration-300 hover:scale-105"
                src={`https://api.microlink.io?url=${encodeURIComponent(items[0].url)}`}
              />
              <div className="p-6">
                <h2 className="text-2xl font-serif mb-2">{items[0].title}</h2>
                <p className="text-sm text-neutral-600 mb-4">
                  {items[0].author} Â· {new Date(data!.the_date).toLocaleDateString()}
                </p>
                <p className="text-neutral-800 mb-4">{items[0].summary}</p>
                <a
                  href={items[0].url}
                  target="_blank"
                  className="inline-block rounded-full border px-4 py-2 text-sm hover:bg-black hover:text-white transition"
                >
                  é˜…è¯»åŸæ–‡
                </a>
              </div>
            </article>
          )}
        </section>

        {/* Secondary */}
        <section className="grid md:grid-cols-2 gap-6 mb-12">
          {items.slice(1).map((it, idx) => (
            <article key={idx} className="rounded-2xl overflow-hidden bg-white shadow-sm">
              <img
                alt={it.title}
                className="w-full aspect-video object-cover transition-transform duration-300 hover:scale-105"
                src={`https://api.microlink.io?url=${encodeURIComponent(it.url)}`}
              />
              <div className="p-6">
                <h3 className="text-xl font-serif mb-2">{it.title}</h3>
                <p className="text-sm text-neutral-600 mb-3">{it.author}</p>
                <p className="text-neutral-800 line-clamp-3 mb-4">{it.summary}</p>
                <a href={it.url} target="_blank" className="inline-block text-sm underline">
                  é˜…è¯»åŸæ–‡
                </a>
              </div>
            </article>
          ))}
        </section>

        {/* Footer */}
        <footer id="about" className="py-10 text-sm text-neutral-600">
          <p>å…³äºæœ¬ç«™ï¼šç”± n8n + GPT + Supabase è‡ªåŠ¨ç”Ÿæˆçš„ AI/ç§‘æŠ€ Substack ç²¾é€‰ã€‚</p>
          <p className="mt-2">æ•°æ®æ¥æºï¼šSubstack Â· å°é¢ï¼šMicrolink API Â· éƒ¨ç½²ï¼šVercel</p>
        </footer>
      </main>
    )
  }
  ```

éªŒæ”¶ï¼š
- [ ] é¡µé¢èƒ½æ­£å¸¸åŠ è½½æœ€æ–°æ–‡ç« æ•°æ®  
- [ ] å°é¢å›¾å¯è§ä¸”åŠ è½½ç¨³å®š  
- [ ] å‡ºé”™æ—¶æ˜¾ç¤ºå‹å¥½æç¤º  

---

### T2.2 è§†è§‰ä¸åŠ¨æ•ˆï¼ˆTailwindï¼‰
- åœ¨ `app/globals.css`ï¼ˆæˆ– `styles/globals.css`ï¼‰ä¸­æ·»åŠ åŸºç¡€è‰²ï¼š
  ```css
  :root {
    --bg: #FAF9F6;
    --fg: #2E2E2E;
    --accent: #1A3E37;
  }
  html, body { background: var(--bg); color: var(--fg); }
  .card { transition: transform .3s ease, opacity .3s ease; }
  .card:hover { transform: scale(1.03); opacity: .98; }
  ```
- åœ¨ `tailwind.config.ts` å¢åŠ å­—ä½“ï¼š
  ```ts
  import type { Config } from 'tailwindcss'
  const config: Config = {
    theme: {
      extend: {
        fontFamily: {
          serif: ['"Playfair Display"', 'serif'],
          sans: ['Inter', 'system-ui', 'sans-serif'],
        },
        colors: {
          bg: '#FAF9F6',
          ink: '#2E2E2E',
          accent: '#1A3E37',
        }
      }
    }
  }
  export default config
  ```

éªŒæ”¶ï¼š
- [ ] èƒŒæ™¯è‰²ä¸º #FAF9F6ï¼Œæ–‡å­—ä¸º #2E2E2Eï¼Œå¼ºè°ƒè‰² #1A3E37  
- [ ] hover ä¸Šæµ®ä¸æ·¡å…¥åŠ¨æ•ˆæ­£å¸¸  
- [ ] ç§»åŠ¨ç«¯å•åˆ—æ˜¾ç¤ºæ­£å¸¸  

---

## Phase 3: éƒ¨ç½²ä¸ä¸Šçº¿

### T3.1 éƒ¨ç½²åˆ° Vercel
- ç™»å½• vercel.com å¹¶å¯¼å…¥ GitHub ä»“åº“  
- åœ¨é¡¹ç›® Settings â†’ Environment Variables æ·»åŠ ï¼š
  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_KEY`
- é€‰æ‹© `main` åˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²

éªŒæ”¶ï¼š
- [ ] éƒ¨ç½²æˆåŠŸï¼Œè®¿é—®ç½‘å€å¯åŠ è½½å†…å®¹  
- [ ] é¡µé¢æ¯æ—¥è‡ªåŠ¨æ›´æ–°  
- [ ] éƒ¨ç½²çŠ¶æ€ä¸ºç»¿è‰² âœ…  

---

## âœ… é¡¹ç›®å®Œæˆæ ‡å‡†
- [ ] æ¯å¤©è‡ªåŠ¨å†™å…¥ 3 ç¯‡æ¨èï¼ˆå‘¨æ—¥ 5 ç¯‡ï¼‰  
- [ ] å‰ç«¯è‡ªåŠ¨å±•ç¤ºæœ€æ–°æ–‡ç« ä¸å°é¢å›¾  
- [ ] é¡µé¢å“åº”é€Ÿåº¦å¿«ä¸”å¸ƒå±€ç¾è§‚  
- [ ] å·²éƒ¨ç½²åœ¨ Vercelï¼Œå¯å…¬å¼€è®¿é—®  
- [ ] æ— æ‰‹åŠ¨å¹²é¢„å³å¯ç¨³å®šè¿è¡Œ  
